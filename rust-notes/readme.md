# Rust学习笔记

## 语法部分

### 变量与可变性
* 声明变量使用let关键字
* 默认情况下，变量是不可变的(Immutable)
* 声明变量时，在变量前面加上mut，就可以使变量可变

### 变量与常量
* 常量(constant)，常量在绑定值以后也是不可变的，但是与不可变变量有很多区别：
  - 不可以使用mut，常量永远都是不可变的
  - 声明常量使用const关键字，并且类型必须标注清楚
  - 常量可以在任意作用域内声明，包括全局作用域
  - 常量只可以绑定到常量表达式，无法绑定到函数的调用结果或只能在运行时才能计算出的值
* 在程序运行期间，常量在其声明的作用域内一直有效
* 命名规范：Rust里常量使用全大写字母，每个单词之间用下划线分开，例如：
  - MAX_POINTS
  - 例子：const MAX_POINTS:u32 = 100_OOO;

### 变量隐藏（shadow）
* 可以使用相同的名字声明新的变量，新的变量会shadow（隐藏）之前的同名变量
* shadow和把变量标记为mut是不一样的：
  - 如果不使用let关键字，重新给非mut的变量赋值会导致编译时错误
  - 而使用let声明的同名新变量，也是不可变的    
  - 使用let声明的同名新变量，它的类型可以与之前不同

示例：
```rust
fn main() {
    let mut guess = String::new();
    // do sth...

    // shadow
    let guess:u32 = guess.trim().parse().expect("Please type a number!"); // 编译器可以根据声明的u32类型，自动推断需要将字符串解析为u32类型
    // do sth...
}
```
这一特性在需要类型转换的场景特别有用，可以复用同一个变量名，这样就不用定义另外一个变量名，比如guess_int之类。

### 数据类型
* 标量和复合类型
* Rust是静态编译语言，在编译时必须知道所有变量的类型
  - 基于使用的值，编译器通常能够推断出它的具体类型
  - 但是如果可能的类型比较多（例如上面把String转为整数的parse方法），就必须添加类型的标注，否则编译会报错

#### 标量类型
* 一个标量类型代表一个单个的值
* Rust有四个主要的标量类型：
  - 整数类型（i8, i16, i32, i64, i128, isize, u8, u16, u32, u64, u128, usize）
  - 浮点类型（f32, f64）
  - 布尔类型（bool: true, false）
  - 字符类型（char, 字面值使用单引号）

isize 和 usize 类型：
* 其位数由程序运行的计算机的架构所决定，如64位计算机，那就是64位的
* 使用isize或usize的主要场景是对某种集合进行索引操作

#### 整数字面值
* 除了byte类型外，所有的数值字面值都允许使用类型后缀
  - 例如 57u8
* 如果不确定使用哪种类型，可以使用Rust相应的默认类型
* 整数的默认类型是i32
  - 总体上来说速度很快，即使在64位系统中

| Number literals | Example  |
|  ----  | ----  |
| Decimal      | 98_222 |
| Hex          | 0xff |
| Octal        | 0o77 |
| Binary       | 0b1111_0000 |
| Byte(u8 only)| b'A' |

#### 整数溢出
* 例如：u8的范围是0-255, 如果把一个u8变量的值设置为256,那么：
  - 调试模式下编译：Rust会检查整数溢出，如果发生溢出，程序在运行时就会panic
  - 发布模式下(--release)编译：Rust不会检查可能导致panic的整数溢出
    * 如果溢出发生：Rust会执行“环绕”操作：256变为0, 257变为1...
    * 但程序不会panic

#### 浮点类型
* Rust有两种基础的浮点类型，也就是包含小数部分的类型
  - f32, 32位  单精度
  - f64, 64位  双精度
* Rust的浮点类型使用了IEEE-754标准来表述
* f64是默认的类型，因为在现代CPU上f64和f32的速度差不多，而且精度更高

#### 字符类型
* Rust中char类型被用来描述语言中最基础的单个字符
* 字符类型的字面值使用单引号
* 占用4字节大小
* 是Unicode标量值，可以表示比ASCII多得多的字符内容：拼音、中日韩文、零长度空白字符、emoji表情等
  - U+0000 到 U+D7FF
  - U+E000 到 U+10FFFF

示例：
```rust
fn main() {
    let x = 'z';
    let y: char = '∑';
    let z = '李️';
}
```    

#### 复合类型










